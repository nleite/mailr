8109      
Delivered-To: norberto@10gen.com
Received: by 10.60.24.70 with SMTP id s6csp230355oef;
        Thu, 6 Sep 2012 11:49:31 -0700 (PDT)
Received: by 10.50.209.99 with SMTP id ml3mr24542704igc.31.1346957370457;
        Thu, 06 Sep 2012 11:49:30 -0700 (PDT)
Return-Path: <mongodb-user+bncCIjShYLrERC24KOCBRoE_4cvTw@googlegroups.com>
Received: from mail-iy0-f192.google.com (mail-iy0-f192.google.com [209.85.210.192])
        by mx.google.com with ESMTPS id qo4si4956424igc.56.2012.09.06.11.49.30
        (version=TLSv1/SSLv3 cipher=OTHER);
        Thu, 06 Sep 2012 11:49:30 -0700 (PDT)
Received-SPF: pass (google.com: domain of mongodb-user+bncCIjShYLrERC24KOCBRoE_4cvTw@googlegroups.com designates 209.85.210.192 as permitted sender) client-ip=209.85.210.192;
Authentication-Results: mx.google.com; spf=pass (google.com: domain of mongodb-user+bncCIjShYLrERC24KOCBRoE_4cvTw@googlegroups.com designates 209.85.210.192 as permitted sender) smtp.mail=mongodb-user+bncCIjShYLrERC24KOCBRoE_4cvTw@googlegroups.com; dkim=pass header.i=@googlegroups.com
Received: by iagf6 with SMTP id f6sf1571460iag.29
        for <multiple recipients>; Thu, 06 Sep 2012 11:49:30 -0700 (PDT)
DKIM-Signature: v=1; a=rsa-sha256; c=relaxed/relaxed;
        d=googlegroups.com; s=20120806;
        h=x-beenthere:date:from:to:message-id:in-reply-to:references:subject
         :mime-version:x-original-sender:x-original-authentication-results
         :reply-to:precedence:mailing-list:list-id:x-google-group-id
         :list-post:list-help:list-archive:sender:list-subscribe
         :list-unsubscribe:content-type;
        bh=a7leZVZ9X1zmQ6m5A4Gtub9LV1q2QMNpHI6t6IG87hA=;
        b=ibYxSEx2FmNrru7FyEuWGRwEWUzGrtH7ryLAC95E3m/vOpuBmQQioXD1x2Z7YeLrtt
         aOwkmp1YjpGajGR/UnV0ptZYW+LacdZp8+pJBkUok4kWd5Bw5DjksaMj+SjhZSgxN0w6
         qOJiyK9/YGaq5yRlHRjpvp96BRyGssbPygZI5AKAbTjDyjixL+9twtTmnaTu+1xwsflD
         Nw8Uy97KQViaWq0BW4ImTSiMBVwnE7X0ytKdThM7IgZMYDpmjqOi5dcy9b129+TIFFfl
         ohJ+5sHUx1DONk3iY5LjiAhjIUJshTRMcFDOWHLDsXMfh2VFK1xH40bGNWmAoWCBwk1e
         yJzQ==
Received: by 10.68.211.6 with SMTP id my6mr825779pbc.15.1346957369794;
        Thu, 06 Sep 2012 11:49:29 -0700 (PDT)
X-BeenThere: mongodb-user@googlegroups.com
Received: by 10.68.237.161 with SMTP id vd1ls3504619pbc.3.gmail; Thu, 06 Sep
 2012 11:49:26 -0700 (PDT)
Received: by 10.68.233.104 with SMTP id tv8mr850645pbc.5.1346957366646;
        Thu, 06 Sep 2012 11:49:26 -0700 (PDT)
Date: Thu, 6 Sep 2012 11:49:26 -0700 (PDT)
From: Michael Champagne <michael.champagne.beauce@gmail.com>
To: mongodb-user@googlegroups.com
Message-Id: <c707945f-9bbd-4203-a383-0af629c877ad@googlegroups.com>
In-Reply-To: <77f0b239-f05d-433f-b6e6-3357bcbe672a@googlegroups.com>
References: <e243df1f-d2b9-4dc3-a58c-6179a91152e4@googlegroups.com>
 <08490b9d-fe66-4d6b-a18f-ff3411a0d561@googlegroups.com>
 <4b06e617-c14a-4d04-a170-8299e267c5ca@googlegroups.com>
 <77f0b239-f05d-433f-b6e6-3357bcbe672a@googlegroups.com>
Subject: [mongodb-user] Re: Creating an efficient system for analytic
 statistics with sharding
MIME-Version: 1.0
X-Original-Sender: michael.champagne.beauce@gmail.com
X-Original-Authentication-Results: ls.google.com; spf=pass (google.com: domain of
 michael.champagne.beauce@gmail.com designates internal as permitted sender)
 smtp.mail=michael.champagne.beauce@gmail.com; dkim=pass
 header.i=@gmail.com
Reply-To: mongodb-user@googlegroups.com
Precedence: list
Mailing-list: list mongodb-user@googlegroups.com; contact mongodb-user+owners@googlegroups.com
List-ID: <mongodb-user.googlegroups.com>
X-Google-Group-Id: 1044811755470
List-Post: <http://groups.google.com/group/mongodb-user/post?hl=en_US>, <mailto:mongodb-user@googlegroups.com>
List-Help: <http://groups.google.com/support/?hl=en_US>, <mailto:mongodb-user+help@googlegroups.com>
List-Archive: <http://groups.google.com/group/mongodb-user?hl=en_US>
Sender: mongodb-user@googlegroups.com
List-Subscribe: <http://groups.google.com/group/mongodb-user/subscribe?hl=en_US>,
 <mailto:mongodb-user+subscribe@googlegroups.com>
List-Unsubscribe: <http://groups.google.com/group/mongodb-user/subscribe?hl=en_US>,
 <mailto:googlegroups-manage+1044811755470+unsubscribe@googlegroups.com>
Content-Type: multipart/alternative; 
	boundary="----=_Part_256_9316618.1346957366239"

------=_Part_256_9316618.1346957366239
Content-Type: text/plain; charset=ISO-8859-1

your fast response is highly appreciated :) and thanks for your advices and 
helpful link.

I agree with you on most points :
 - don't embed eventTypes within events,
 - keep eventTypes in cache to do less reads when writing,
 - shorten document keys.

There is one thing I'm still not sure of. Should I *crunch* my data at one 
time during the day, or aggregate events at insertion like you explained...
We both know that I need the fastest inserting path possible. But you would 
do an update for aggregated values when inserting, thus adding one more 
operation. I was thinking that maybe it would be better to have a daily 
process to do those calculations. Insertion of new events would be faster 
that way. What do you think ?

What I like of your implementation (updating aggregated value at insertion) 
is that I can have a real-time value of the present day. But be aware that 
I don't need this behavior. It would only be a plus.

*Sharding*
I think the choices for sharding depend on if I choose to crunch data once 
per day into daily stats, or I keep a document with the aggregated value. 
With a daily_event_totals collection, i would not need to query the events 
collection. Am I right ? (Knowing that is because my only goal is to serve 
daily statistics)

I will try with a key made of day + user + eventType. What would be the 
benefits of adding a random part as you suggested ?

-- 
You received this message because you are subscribed to the Google
Groups "mongodb-user" group.
To post to this group, send email to mongodb-user@googlegroups.com
To unsubscribe from this group, send email to
mongodb-user+unsubscribe@googlegroups.com
See also the IRC channel -- freenode.net#mongodb

------=_Part_256_9316618.1346957366239
Content-Type: text/html; charset=ISO-8859-1
Content-Transfer-Encoding: quoted-printable

your fast response is highly appreciated :) and thanks for your advices and=
 helpful link.<br><br>I agree with you on most points :<br>

&nbsp;- don't embed eventTypes within events,<br>&nbsp;- keep eventTypes in=
 cache to do less reads when writing,<br>&nbsp;- shorten document keys.<br>=
<br>There is one thing I'm still not sure of. Should I <i>crunch</i> my dat=
a at one time during the day, or aggregate events at insertion like you exp=
lained...<br>

We both know that I need the fastest inserting path possible. But you=20
would do an update for aggregated values when inserting, thus adding one
 more operation. I was thinking that maybe it would be better to have a=20
daily process to do those calculations. Insertion of new events would be
 faster that way. What do you think ?<br>

<br>What I like of your implementation (updating aggregated value at=20
insertion) is that I can have a real-time value of the present day. But=20
be aware that I don't need this behavior. It would only be a plus.<br><br><=
u><b>Sharding</b></u><br>

I think the choices for sharding depend on if I choose to crunch data=20
once per day into daily stats, or I keep a document with the aggregated=20
value. With a daily_event_totals collection, i would not need to query=20
the events collection. Am I right ? (Knowing that is because my only=20
goal is to serve daily statistics)<br>

<br>I will try with a key made of day + user + eventType. What would be the=
 benefits of adding a random part as you suggested ?

<p></p>

-- <br />
You received this message because you are subscribed to the Google<br />
Groups &quot;mongodb-user&quot; group.<br />
To post to this group, send email to mongodb-user@googlegroups.com<br />
To unsubscribe from this group, send email to<br />
mongodb-user+unsubscribe@googlegroups.com<br />
See also the IRC channel -- freenode.net#mongodb<br />

------=_Part_256_9316618.1346957366239--
<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE plist PUBLIC "-//Apple//DTD PLIST 1.0//EN" "http://www.apple.com/DTDs/PropertyList-1.0.dtd">
<plist version="1.0">
<dict>
	<key>date-sent</key>
	<real>1346957366</real>
	<key>flags</key>
	<integer>8590195712</integer>
	<key>original-mailbox</key>
	<string>imap://norberto%4010gen.com@imap.gmail.com/mongodb-user</string>
	<key>remote-id</key>
	<string>1856</string>
	<key>subject</key>
	<string>[mongodb-user] Re: Creating an efficient system for analytic statistics with sharding</string>
</dict>
</plist>
